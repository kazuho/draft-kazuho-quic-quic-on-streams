<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>QUIC on Streams</title>
<meta content="Kazuho Oku" name="author">
<meta content="Lucas Pardue" name="author">
<meta content="
       This document specifies a polyfill of QUIC version 1 that runs on top of
bi-directional streams such as TLS. 
    " name="description">
<meta content="xml2rfc 3.19.1" name="generator">
<meta content="internet-draft" name="keyword">
<meta content="draft-kazuho-quic-quic-on-streams-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.19.1
    Python 3.11.6
    ConfigArgParse 1.7
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.3
    platformdirs 4.1.0
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.31.0
    setuptools 68.2.2
    six 1.16.0
    wcwidth 0.2.13
-->
<link href="draft-kazuho-quic-quic-on-streams.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">QUIC on Streams</td>
<td class="right">January 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Oku &amp; Pardue</td>
<td class="center">Expires 3 August 2024</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">QUIC</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-kazuho-quic-quic-on-streams-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-01-31" class="published">31 January 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2024-08-03">3 August 2024</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">K. Oku</div>
<div class="org">Fastly</div>
</div>
<div class="author">
      <div class="author-name">L. Pardue</div>
<div class="org">Cloudflare</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">QUIC on Streams</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies a polyfill of QUIC version 1 that runs on top of
bi-directional streams such as TLS.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
    QUIC Working Group mailing list (quic@ietf.org),
    which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/quic/">https://mailarchive.ietf.org/arch/browse/quic/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
    <span><a href="https://github.com/kazuho/draft-kazuho-quic-quic-on-streams">https://github.com/kazuho/draft-kazuho-quic-quic-on-streams</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 3 August 2024.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-the-protocol" class="internal xref">The Protocol</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-properties-of-underlying-tr" class="internal xref">Properties of Underlying Transport</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-quic-frames" class="internal xref">QUIC Frames</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-stream-frames" class="internal xref">STREAM Frames</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="auto internal xref">4.1.1</a>.  <a href="#name-stream-frames-without-the-l" class="internal xref">STREAM Frames without the Length Field</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="auto internal xref">4.1.2</a>.  <a href="#name-ordering-of-stream-frames" class="internal xref">Ordering of STREAM frames</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-qs_transport_parameters-fra" class="internal xref">QS_TRANSPORT_PARAMETERS Frames</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-qs_ping-frames" class="internal xref">QS_PING Frames</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-transport-parameters" class="internal xref">Transport Parameters</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-permitted-and-forbidden-tra" class="internal xref">Permitted and Forbidden Transport Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-max_frame_size-transport-pa" class="internal xref">max_frame_size Transport Parameter</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-closing-the-connection" class="internal xref">Closing the Connection</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-using-0-rtt" class="internal xref">Using 0-RTT</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-extensions" class="internal xref">Extensions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-unreliable-datagram-extensi" class="internal xref">Unreliable Datagram Extension</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-version-agility" class="internal xref">Version Agility</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-implementation-consideratio" class="internal xref">Implementation Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="auto internal xref">13.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="auto internal xref">13.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">QUIC version 1 <span>[<a href="#QUIC" class="cite xref">QUIC</a>]</span> is a bi-directional, authenticated
transport-layer protocol built on top of UDP <span>[<a href="#UDP" class="cite xref">UDP</a>]</span>. The protocol
provides multiplexed flow-controlled streams without head-of-line blocking as a
core service. It also offers low-latency connection establishment and efficient
loss recovery.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">However, there are downsides to QUIC.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">One downside is that QUIC, being based on UDP, is not as universally accessible
as TCP <span>[<a href="#TCP" class="cite xref">TCP</a>]</span>, due to occasionally being blocked by middleboxes.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">Another downside is that QUIC is computationally more expensive compared to TLS
<span>[<a href="#TLS13" class="cite xref">TLS13</a>]</span> over TCP. This increased cost is partly because QUIC encrypts
each packet, which is smaller than the encryption unit of TLS, leading to more
overhead, and partly because UDP is less optimized within computing
infrastructures.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">Due to these limitations, applications are often served using both QUIC and TCP.
QUIC is employed to provide the optimal user experience, while TCP acts as a
fallback for ensuring network reachability and computational efficiency as
needed.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">One such example is HTTP, which has different bindings for QUIC (HTTP/3
<span>[<a href="#HTTP3" class="cite xref">HTTP3</a>]</span>) and TCP (HTTP/2 <span>[<a href="#HTTP2" class="cite xref">HTTP2</a>]</span>). Recently, security
concerns have prompted proposals to revise HTTP/2
(<span>[<a href="#h2-stream-limits" class="cite xref">h2-stream-limits</a>]</span>), which has sparked
discussions about the costs of maintaining multiple HTTP versions.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">Another example is WebTransport, a superset of HTTP. Because HTTP has different
bindings for QUIC and TCP, WebTransport defines its own extensions for the two
HTTP variants (<span>[<a href="#webtrans-h3" class="cite xref">webtrans-h3</a>]</span>,
<span>[<a href="#webtrans-h2" class="cite xref">webtrans-h2</a>]</span>).<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">To reduce or eliminate the costs associated with duplicated efforts in providing
services on top of both transport protocols, this document specifies a polyfill
that allows application protocols built on QUIC to run on transport protocols
that provide single bi-directional, byte-oriented stream such as TCP or TLS.<a href="#section-1-8" class="pilcrow">¶</a></p>
<p id="section-1-9">The specified polyfill provides a compatibility layer for the set of operations
(i.e., API) required by QUIC, as specified in Section <a href="https://rfc-editor.org/rfc/rfc9000#section-2.4" class="relref">2.4</a> and Section <a href="https://rfc-editor.org/rfc/rfc9000#section-5.3" class="relref">5.3</a> of <span>[<a href="#QUIC" class="cite xref">QUIC</a>]</span>.<a href="#section-1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="the-protocol">
<section id="section-3">
      <h2 id="name-the-protocol">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-the-protocol" class="section-name selfRef">The Protocol</a>
      </h2>
<p id="section-3-1">QUIC on Streams can be used on any transport that provides bi-directional,
byte-oriented stream that is ordered and reliable; for details, see
<a href="#transport-properties" class="auto internal xref">Section 3.1</a>.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">QUIC frames are sent directly on top of the transport.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">The frames are not encrypted. It is the task of the transport (e.g., TLS) to
provide confidentially and integrity.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">QUIC packet headers are not used.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">For exchanging the Transport Parameters, a new frame called
QS_TRANSPORT_PARAMETERS frame is defined.<a href="#section-3-5" class="pilcrow">¶</a></p>
<div id="transport-properties">
<section id="section-3.1">
        <h3 id="name-properties-of-underlying-tr">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-properties-of-underlying-tr" class="section-name selfRef">Properties of Underlying Transport</a>
        </h3>
<p id="section-3.1-1">QUIC on Streams is designed to work on top of transport layer protocols that
provide the following capabilities:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.1-2">
          <dt id="section-3.1-2.1">In-order delivery of bytes in both direction:</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-2.2">
            <p id="section-3.1-2.2.1">Underlying transport provides a byte-oriented and bi-directional stream that
deliver the bytes in order; i.e., bytes that were sent in one order become
available to the receiving side in the same order.<a href="#section-3.1-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.3">Guaranteed delivery:</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-2.4">
            <p id="section-3.1-2.4.1">If the transport runs on top of a lossy network, that transport recovers the
bytes lost; e.g., by retransmitting them. This requires buffering and
reassembly, in order to achieve the first bullet point (in-order delivery).<a href="#section-3.1-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.5">Congestion control:</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-2.6">
            <p id="section-3.1-2.6.1">When used on a shared network, the transport is congestion controlled.
Implementations of QUIC on Streams simply write outgoing frames to the
transport when that transport permits to.<a href="#section-3.1-2.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.7">Confidentially and Integrity:</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-2.8">
            <p id="section-3.1-2.8.1">Unless used upon endpoints between which tampering or monitoring is a
non-concern, the transport provides confidentially and integrity protection.<a href="#section-3.1-2.8.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.1-3">TLS over TCP provides all these capabilities.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4">UNIX sockets are an example that provides only the first two. Congestion control
is not employed, as UNIX sockets do not face a shared bottleneck.
Confidentiality and integrity protection are deemed unnecessary in environments
where the operating system is trusted.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="quic-frames">
<section id="section-4">
      <h2 id="name-quic-frames">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-quic-frames" class="section-name selfRef">QUIC Frames</a>
      </h2>
<p id="section-4-1">In QUIC on Streams, the following QUIC frames can be used, as if they were sent
or received in the application packet number space:<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1">
          <p id="section-4-2.1.1">PADDING<a href="#section-4-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.2">
          <p id="section-4-2.2.1">RESET_STREAM<a href="#section-4-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.3">
          <p id="section-4-2.3.1">STOP_SENDING<a href="#section-4-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.4">
          <p id="section-4-2.4.1">STREAM<a href="#section-4-2.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.5">
          <p id="section-4-2.5.1">MAX_DATA<a href="#section-4-2.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.6">
          <p id="section-4-2.6.1">MAX_STREAM_DATA<a href="#section-4-2.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.7">
          <p id="section-4-2.7.1">MAX_STREAMS<a href="#section-4-2.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.8">
          <p id="section-4-2.8.1">DATA_BLOCKED<a href="#section-4-2.8.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.9">
          <p id="section-4-2.9.1">STREAM_DATA_BLOCKED<a href="#section-4-2.9.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.10">
          <p id="section-4-2.10.1">STREAMS_BLOCKED<a href="#section-4-2.10.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.11">
          <p id="section-4-2.11.1">CONNECTION_CLOSE<a href="#section-4-2.11.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-3">The frame formats are identical to those in QUIC version 1. Likewise, the
meaning and requirements for the use of these frames are consistent with QUIC
version 1, with the exception to the specific changes made to the STREAM frames,
as detailed in <a href="#stream-frames" class="auto internal xref">Section 4.1</a>.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">Use of other frames defined in QUIC version 1 is prohibited. Namely, ACK frames
are not used, because the underlying transport guarantees delivery. Use of
frames that communicate Connection IDs and those related to path migration is
forbidden.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">If an endpoint receives one of the prohibited frames, the endpoint <span class="bcp14">MUST</span> close
the connection with an error of type FRAME_ENCODING_ERROR.<a href="#section-4-5" class="pilcrow">¶</a></p>
<div id="stream-frames">
<section id="section-4.1">
        <h3 id="name-stream-frames">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-stream-frames" class="section-name selfRef">STREAM Frames</a>
        </h3>
<p id="section-4.1-1">While the frame format remains unchanged, there are two differences in the
handling of STREAM frames between QUIC version 1 and QUIC on Streams.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div id="stream-frames-without-the-length-field">
<section id="section-4.1.1">
          <h4 id="name-stream-frames-without-the-l">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-stream-frames-without-the-l" class="section-name selfRef">STREAM Frames without the Length Field</a>
          </h4>
<p id="section-4.1.1-1">In QUIC on Streams, when a STREAM frame that omits the Length field is used, the
size of that STREAM frame is determined by the maximum frame size, as regulated
by the <code>max_frame_size</code> Transport Parameter (<a href="#max_frame_size" class="auto internal xref">Section 5.2</a>).<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.1-2">This behavior contrasts with that of QUIC version 1, where the absence of the
Length field implies that the STREAM frame extends to the end of the QUIC packet
payload.<a href="#section-4.1.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1.1-3">This variation arises due to the characteristics of the underlying transports of
QUIC on Streams, which may not have, or provide visibility into, the packet
boundaries.<a href="#section-4.1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ordering-of-stream-frames">
<section id="section-4.1.2">
          <h4 id="name-ordering-of-stream-frames">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-ordering-of-stream-frames" class="section-name selfRef">Ordering of STREAM frames</a>
          </h4>
<p id="section-4.1.2-1">For each stream being sent, senders <span class="bcp14">MUST</span> send stream payload in order.<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2-2">When receiving a STREAM frame that carries a payload not immediately following
the payload of the previous STREAM frame for the same Stream ID, receivers <span class="bcp14">MUST</span>
close connection with an error of type PROTOCOL_VIOLATION_ERROR.<a href="#section-4.1.2-2" class="pilcrow">¶</a></p>
<p id="section-4.1.2-3">This change from QUIC version 1 eliminates the need for implementations to
buffer and reassemble the stream payload. As a result, the payload being
received can be directly passed to the application as it is read from the
transport. This efficiency is due to the underlying transport's guarantee of
in-order delivery.<a href="#section-4.1.2-3" class="pilcrow">¶</a></p>
<p id="section-4.1.2-4">These changes do not impact the senders' capability to interleave STREAM frames
from multiple streams.<a href="#section-4.1.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="qstransportparameters-frames">
<section id="section-4.2">
        <h3 id="name-qs_transport_parameters-fra">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-qs_transport_parameters-fra" class="section-name selfRef">QS_TRANSPORT_PARAMETERS Frames</a>
        </h3>
<p id="section-4.2-1">In QUIC on Streams, Transport Parameters are exchanged as frames.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">QS_TRANSPORT_PARAMETERS frames are formatted as shown in
<a href="#fig-qs-transport-parameters" class="auto internal xref">Figure 1</a>.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<span id="name-qs_transport_parameters-fram"></span><div id="fig-qs-transport-parameters">
<figure id="figure-1">
          <div class="alignLeft art-text artwork" id="section-4.2-3.1">
<pre>
QS_TRANSPORT_PARAMETERS Frame {
  Type (i) = 0x3f5153300d0a0d0a,
  Length (i),
  Transport Parameters (..),
}
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-qs_transport_parameters-fram" class="selfRef">QS_TRANSPORT_PARAMETERS Frame Format</a>
          </figcaption></figure>
</div>
<p id="section-4.2-4">QS_TRANSPORT_PARAMETERS frames contain the following fields:<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2-5">
          <dt id="section-4.2-5.1">Length:</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-5.2">
            <p id="section-4.2-5.2.1">A variable-length integer specifying the length of the Transport Parameters
field in this QS_TRANSPORT_PARAMETERS frame.<a href="#section-4.2-5.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-5.3">Transport Parameters:</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-5.4">
            <p id="section-4.2-5.4.1">The Transport Parameters. The encoding of the payload is as defined in
<span><a href="https://rfc-editor.org/rfc/rfc9000#section-18" class="relref">Section 18</a> of [<a href="#QUIC" class="cite xref">QUIC</a>]</span>.<a href="#section-4.2-5.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-6">The QS_TRANSPORT_PARAMETERS frame is the first frame being sent by endpoints.
Endpoints <span class="bcp14">MUST</span> send the QS_TRANSPORT_PARAMETERS frame as soon as the underlying
transport becomes available. Note neither endpoint needs to wait for the
peer's Transport Parameters before sending its own, as Transport Parameters are
a unilateral declaration of an endpoint's capabilities
(<span><a href="https://rfc-editor.org/rfc/rfc9000#section-7.4" class="relref">Section 7.4</a> of [<a href="#QUIC" class="cite xref">QUIC</a>]</span>).<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<p id="section-4.2-7">If the first frame being received by an endpoint is not a
QS_TRANSPORT_PARAMETERS frame, the endpoint <span class="bcp14">MUST</span> close the connection with an
error of type TRANSPORT_PARAMETER_ERROR.<a href="#section-4.2-7" class="pilcrow">¶</a></p>
<p id="section-4.2-8">The frame type (0x3f5153300d0a0d0a; "\xffQS0\r\n\r\n" on wire) has been chosen
so that it can be used to disambiguate QUIC on Streams from HTTP/1.1
<span>[<a href="#HTTP1" class="cite xref">HTTP1</a>]</span> and HTTP/2.<a href="#section-4.2-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="qsping-frames">
<section id="section-4.3">
        <h3 id="name-qs_ping-frames">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-qs_ping-frames" class="section-name selfRef">QS_PING Frames</a>
        </h3>
<p id="section-4.3-1">In QUIC on Streams, QS_PING frames allow endpoints to test peer reachability
above the underlying transport.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">QS_PING frames are formatted as shown in <a href="#fig-qs-ping" class="auto internal xref">Figure 2</a>.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<span id="name-qs_ping-frame-format"></span><div id="fig-qs-ping">
<figure id="figure-2">
          <div class="alignLeft art-text artwork" id="section-4.3-3.1">
<pre>
QS_PING Frame {
  Type (i) = 0xTBD..0xTBD+1,
  Sequence Number (i),
}
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-qs_ping-frame-format" class="selfRef">QS_PING Frame Format</a>
          </figcaption></figure>
</div>
<p id="section-4.3-4">Type 0xTBD is used for sending a ping (i.e., request the peer to respond). Type
0xTBD+1 is used in response.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<p id="section-4.3-5">QS_PING frames contain the following fields:<a href="#section-4.3-5" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.3-6">
          <dt id="section-4.3-6.1">Sequence Number:</dt>
          <dd style="margin-left: 1.5em" id="section-4.3-6.2">
            <p id="section-4.3-6.2.1">A variable-length integer used to identify the ping.<a href="#section-4.3-6.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.3-7">When sending QS_PING frames of type 0xTBD, endpoints <span class="bcp14">MUST</span> send monotonically
increasing values in the Sequence Number field, since that allows the endpoints
to identify to which ping the peer has responded.<a href="#section-4.3-7" class="pilcrow">¶</a></p>
<p id="section-4.3-8">When sending QS_PING frames of type 0xTBD+1 in response, endpoints <span class="bcp14">MUST</span> echo the
Sequence Number that they received.<a href="#section-4.3-8" class="pilcrow">¶</a></p>
<p id="section-4.3-9">When receiving multiple QS_PING frames of type 0xTBD before having the chance to
respond, an endpoint <span class="bcp14">MAY</span> only respond with one QS_PING frame of type 0xTBD+1
carrying the largest Sequence Number that the endpoint has received.<a href="#section-4.3-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="transport-parameters">
<section id="section-5">
      <h2 id="name-transport-parameters">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-transport-parameters" class="section-name selfRef">Transport Parameters</a>
      </h2>
<p id="section-5-1">QUIC on Streams uses a subset of Transport Parameters defined in QUIC version 1.
Also, one new Transport Parameter specific to QUIC on Streams is defined.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="permitted-tps">
<section id="section-5.1">
        <h3 id="name-permitted-and-forbidden-tra">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-permitted-and-forbidden-tra" class="section-name selfRef">Permitted and Forbidden Transport Parameters</a>
        </h3>
<p id="section-5.1-1">In QUIC on Streams, use of the following Transport Parameters is allowed.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-2.1">
            <p id="section-5.1-2.1.1">max_idle_timeout<a href="#section-5.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-2.2">
            <p id="section-5.1-2.2.1">initial_max_data<a href="#section-5.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-2.3">
            <p id="section-5.1-2.3.1">initial_max_stream_data_bidi_local<a href="#section-5.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-2.4">
            <p id="section-5.1-2.4.1">initial_max_stream_data_bidi_remote<a href="#section-5.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-2.5">
            <p id="section-5.1-2.5.1">initial_max_stream_data_uni<a href="#section-5.1-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-2.6">
            <p id="section-5.1-2.6.1">initial_max_streams_bidi<a href="#section-5.1-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-2.7">
            <p id="section-5.1-2.7.1">initial_max_streams_uni<a href="#section-5.1-2.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.1-3">The definition of these Transport Parameters are unchanged.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">Use of other Transport Parameters defined in QUIC version 1 is prohibited. When
an endpoint receives one of the prohibited Transport Parameters, the endpoint
<span class="bcp14">MUST</span> close the connection with an error of type TRANSPORT_PARAMETER_ERROR.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">Endpoints <span class="bcp14">MUST NOT</span> send Transport Parameters that extend QUIC version 1, unless
they are specified to be compatible with QUIC on Streams.<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<p id="section-5.1-6">When receiving Transport Parameters not defined in QUIC version 1, receivers
<span class="bcp14">MUST</span> ignore them unless they are specified to be usable on QUIC on Streams.<a href="#section-5.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="max_frame_size">
<section id="section-5.2">
        <h3 id="name-max_frame_size-transport-pa">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-max_frame_size-transport-pa" class="section-name selfRef">max_frame_size Transport Parameter</a>
        </h3>
<p id="section-5.2-1">The <code>max_frame_size</code> Transport Parameter (0xTBD) is a variable-length integer
specifying the maximum size of the QUIC frame that the peer can send, in the
unit of bytes.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">The initial value of the <code>max_frame_size</code> Transport Parameter is 16384.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">By sending the Transport Parameter, the maximum frame size can only be
increased. When receiving a value below the initial value, receivers <span class="bcp14">MUST</span> close
the connection with an error of type TRANSPORT_PARAMETER_ERROR.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">Endpoints <span class="bcp14">MUST NOT</span> send QUIC frames that exceed the maximum declared by the
peer.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2-5">When receiving QUIC frames that exceed the declared maximum, receivers <span class="bcp14">MUST</span>
close the connection with an error of type FRAME_ENCODING_ERROR.<a href="#section-5.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="closing-the-connection">
<section id="section-6">
      <h2 id="name-closing-the-connection">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-closing-the-connection" class="section-name selfRef">Closing the Connection</a>
      </h2>
<p id="section-6-1">As is with QUIC version 1, a connection can be closed either by a
CONNECTION_CLOSE frame or by an idle timeout.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">Unlike QUIC version 1, there is no draining period; once an endpoint sends or
receives the CONNECTION_CLOSE frame or reaches the idle timeout, all the
resources allocated for the Service are freed and the underlying transport is
closed immediately.<a href="#section-6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="using-0-rtt">
<section id="section-7">
      <h2 id="name-using-0-rtt">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-using-0-rtt" class="section-name selfRef">Using 0-RTT</a>
      </h2>
<p id="section-7-1">TLS 1.3 introduced the concept of early data (also knows as 0-RTT data).<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">When using QUIC on Streams on top of TLS that supports early data, clients <span class="bcp14">MAY</span>
use early data when resuming a connection, by reusing certain Transport
Parameters as defined in <span><a href="https://rfc-editor.org/rfc/rfc9000#section-7.4.1" class="relref">Section 7.4.1</a> of [<a href="#QUIC" class="cite xref">QUIC</a>]</span>.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">Similarly, when accepting early data, the servers <span class="bcp14">MUST</span> send Transport Parameters
that obey to the restrictions defined in <span><a href="https://rfc-editor.org/rfc/rfc9000#section-7.4.1" class="relref">Section 7.4.1</a> of [<a href="#QUIC" class="cite xref">QUIC</a>]</span>.<a href="#section-7-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="extensions">
<section id="section-8">
      <h2 id="name-extensions">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-extensions" class="section-name selfRef">Extensions</a>
      </h2>
<p id="section-8-1">Not all the extensions of QUIC version 1 can be used. Each extension have to
define its mapping for QUIC on Streams, or explicitly allow the use; see
<a href="#permitted-tps" class="auto internal xref">Section 5.1</a>.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">As is the case with QUIC version 1, use of extension frames have to be
negotiated before use; see <span><a href="https://rfc-editor.org/rfc/rfc9000#section-19.21" class="relref">Section 19.21</a> of [<a href="#QUIC" class="cite xref">QUIC</a>]</span>.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">This specification defines the mapping of the Unreliable Datagram Extension.<a href="#section-8-3" class="pilcrow">¶</a></p>
<div id="unreliable-datagram-extension">
<section id="section-8.1">
        <h3 id="name-unreliable-datagram-extensi">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-unreliable-datagram-extensi" class="section-name selfRef">Unreliable Datagram Extension</a>
        </h3>
<p id="section-8.1-1">The use of the Unreliable Datagram Extension <span>[<a href="#QUIC_DATAGRAM" class="cite xref">QUIC_DATAGRAM</a>]</span> is
permitted, with one modification:<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">Similar to STREAM frames, when employing DATAGRAM frames of type 0x30 (i.e.,
DATAGRAM frames without the Length field), their size is determined by the
<code>max_frame_size</code> Transport Parameter (<a href="#max_frame_size" class="auto internal xref">Section 5.2</a>).<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<p id="section-8.1-3">Apart from this, the encoding and semantics of the Unreliable Datagram Extension
remain unchanged. The use of the extension is negotiated via the Transport
Parameters.<a href="#section-8.1-3" class="pilcrow">¶</a></p>
<p id="section-8.1-4">As discussed in <span><a href="https://rfc-editor.org/rfc/rfc9221#section-5" class="relref">Section 5</a> of [<a href="#QUIC_DATAGRAM" class="cite xref">QUIC_DATAGRAM</a>]</span>, senders can drop DATAGRAM frames
if the transport is blocked by flow or congestion control.<a href="#section-8.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="version-agility">
<section id="section-9">
      <h2 id="name-version-agility">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-version-agility" class="section-name selfRef">Version Agility</a>
      </h2>
<p id="section-9-1">Unlike QUIC, QUIC on Streams does not define a mechanism for version
negotiation.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">In large-scale deployments requiring service and protocol version discovery,
QUIC on Streams can and is likely to be implemented over TLS. The
Application-Layer Protocol Negotiation Extension of TLS <span>[<a href="#ALPN" class="cite xref">ALPN</a>]</span> is the
favored mechanism to negotiate between an application protocol based on this
specification and others.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">When ALPN is unavailable, first 8 bytes exchanged on the transport (i.e., the
type field of the QS_TRANSPORT_PARAMETERS frame in the encoded form) can be used
to identify if QUIC on Streams is in use.<a href="#section-9-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="implementation-considerations">
<section id="section-10">
      <h2 id="name-implementation-consideratio">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-implementation-consideratio" class="section-name selfRef">Implementation Considerations</a>
      </h2>
<p id="section-10-1">Similar to HTTP/3 with Extensible Priorities <span>[<a href="#HTTP_PRIORITY" class="cite xref">HTTP_PRIORITY</a>]</span>,
application protocols using QUIC may employ stream multiplexing along with a
system to tune the delivery sequence of QUIC streams.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">To alternate between QUIC streams of varying priorities in a timely manner, it
is advisable for QUIC on Streams implementations to avoid creating deep buffers
holding QUIC frames. Instead, endpoints should wait for the transport layer to
be ready for writing. Upon becoming writable, they should write QUIC frames
according to the latest prioritization signals.<a href="#section-10-2" class="pilcrow">¶</a></p>
<p id="section-10-3">Additionally, implementations may consider monitoring or adjusting the flow and
congestion control parameters of the underlying transport. This approach aims to
minimize data buffering within the transport layer before transmission. However,
improper adjustment of these parameters could potentially lead to lower
throughput.<a href="#section-10-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-11">
      <h2 id="name-security-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-11-1">TODO Security<a href="#section-11-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-12">
      <h2 id="name-iana-considerations">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-12-1">TODO<a href="#section-12-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-13">
      <h2 id="name-references">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-13.1">
        <h3 id="name-normative-references">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="QUIC">[QUIC]</dt>
        <dd>
<span class="refAuthor">Iyengar, J., Ed.</span> and <span class="refAuthor">M. Thomson, Ed.</span>, <span class="refTitle">"QUIC: A UDP-Based Multiplexed and Secure Transport"</span>, <span class="seriesInfo">RFC 9000</span>, <span class="seriesInfo">DOI 10.17487/RFC9000</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9000">https://www.rfc-editor.org/rfc/rfc9000</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="QUIC_DATAGRAM">[QUIC_DATAGRAM]</dt>
        <dd>
<span class="refAuthor">Pauly, T.</span>, <span class="refAuthor">Kinnear, E.</span>, and <span class="refAuthor">D. Schinazi</span>, <span class="refTitle">"An Unreliable Datagram Extension to QUIC"</span>, <span class="seriesInfo">RFC 9221</span>, <span class="seriesInfo">DOI 10.17487/RFC9221</span>, <time datetime="2022-03" class="refDate">March 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9221">https://www.rfc-editor.org/rfc/rfc9221</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TLS13">[TLS13]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-13.2">
        <h3 id="name-informative-references">
<a href="#section-13.2" class="section-number selfRef">13.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="ALPN">[ALPN]</dt>
        <dd>
<span class="refAuthor">Friedl, S.</span>, <span class="refAuthor">Popov, A.</span>, <span class="refAuthor">Langley, A.</span>, and <span class="refAuthor">E. Stephan</span>, <span class="refTitle">"Transport Layer Security (TLS) Application-Layer Protocol Negotiation Extension"</span>, <span class="seriesInfo">RFC 7301</span>, <span class="seriesInfo">DOI 10.17487/RFC7301</span>, <time datetime="2014-07" class="refDate">July 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7301">https://www.rfc-editor.org/rfc/rfc7301</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="h2-stream-limits">[h2-stream-limits]</dt>
        <dd>
<span class="refAuthor">Thomson, M.</span> and <span class="refAuthor">L. Pardue</span>, <span class="refTitle">"Using HTTP/3 Stream Limits in HTTP/2"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-thomson-httpbis-h2-stream-limits-00</span>, <time datetime="2023-11-06" class="refDate">6 November 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-thomson-httpbis-h2-stream-limits-00">https://datatracker.ietf.org/doc/html/draft-thomson-httpbis-h2-stream-limits-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="HTTP1">[HTTP1]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span>, <span class="refAuthor">Nottingham, M., Ed.</span>, and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"HTTP/1.1"</span>, <span class="seriesInfo">STD 99</span>, <span class="seriesInfo">RFC 9112</span>, <span class="seriesInfo">DOI 10.17487/RFC9112</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9112">https://www.rfc-editor.org/rfc/rfc9112</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="HTTP2">[HTTP2]</dt>
        <dd>
<span class="refAuthor">Thomson, M., Ed.</span> and <span class="refAuthor">C. Benfield, Ed.</span>, <span class="refTitle">"HTTP/2"</span>, <span class="seriesInfo">RFC 9113</span>, <span class="seriesInfo">DOI 10.17487/RFC9113</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9113">https://www.rfc-editor.org/rfc/rfc9113</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="HTTP3">[HTTP3]</dt>
        <dd>
<span class="refAuthor">Bishop, M., Ed.</span>, <span class="refTitle">"HTTP/3"</span>, <span class="seriesInfo">RFC 9114</span>, <span class="seriesInfo">DOI 10.17487/RFC9114</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9114">https://www.rfc-editor.org/rfc/rfc9114</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="HTTP_PRIORITY">[HTTP_PRIORITY]</dt>
        <dd>
<span class="refAuthor">Oku, K.</span> and <span class="refAuthor">L. Pardue</span>, <span class="refTitle">"Extensible Prioritization Scheme for HTTP"</span>, <span class="seriesInfo">RFC 9218</span>, <span class="seriesInfo">DOI 10.17487/RFC9218</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9218">https://www.rfc-editor.org/rfc/rfc9218</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TCP">[TCP]</dt>
        <dd>
<span class="refAuthor">Eddy, W., Ed.</span>, <span class="refTitle">"Transmission Control Protocol (TCP)"</span>, <span class="seriesInfo">STD 7</span>, <span class="seriesInfo">RFC 9293</span>, <span class="seriesInfo">DOI 10.17487/RFC9293</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9293">https://www.rfc-editor.org/rfc/rfc9293</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="UDP">[UDP]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"User Datagram Protocol"</span>, <span class="seriesInfo">STD 6</span>, <span class="seriesInfo">RFC 768</span>, <span class="seriesInfo">DOI 10.17487/RFC0768</span>, <time datetime="1980-08" class="refDate">August 1980</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc768">https://www.rfc-editor.org/rfc/rfc768</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="webtrans-h2">[webtrans-h2]</dt>
        <dd>
<span class="refAuthor">Frindell, A.</span>, <span class="refAuthor">Kinnear, E.</span>, <span class="refAuthor">Pauly, T.</span>, <span class="refAuthor">Thomson, M.</span>, <span class="refAuthor">Vasiliev, V.</span>, and <span class="refAuthor">G. Xie</span>, <span class="refTitle">"WebTransport over HTTP/2"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-webtrans-http2-07</span>, <time datetime="2023-10-23" class="refDate">23 October 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-webtrans-http2-07">https://datatracker.ietf.org/doc/html/draft-ietf-webtrans-http2-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="webtrans-h3">[webtrans-h3]</dt>
      <dd>
<span class="refAuthor">Frindell, A.</span>, <span class="refAuthor">Kinnear, E.</span>, and <span class="refAuthor">V. Vasiliev</span>, <span class="refTitle">"WebTransport over HTTP/3"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-webtrans-http3-08</span>, <time datetime="2023-10-23" class="refDate">23 October 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-webtrans-http3-08">https://datatracker.ietf.org/doc/html/draft-ietf-webtrans-http3-08</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">TODO acknowledge.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Kazuho Oku</span></div>
<div dir="auto" class="left"><span class="org">Fastly</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:kazuhooku@gmail.com" class="email">kazuhooku@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Lucas Pardue</span></div>
<div dir="auto" class="left"><span class="org">Cloudflare</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:lucas@lucaspardue.com" class="email">lucas@lucaspardue.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
